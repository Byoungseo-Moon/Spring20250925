<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.test1.mapper.MemberMapper">
	<select id="memberLogin" parameterType="hashmap" resultType="com.example.test1.model.Member">
		SELECT *
		FROM TBL_USER
		WHERE USERID = #{id} AND PASSWORD = #{pwd}   		
	</select>
	
	<select id="selectMemberList" parameterType="hashmap" resultType="com.example.test1.model.Member">
		SELECT
			U.*,
			DECODE(
				BIRTH,
				NULL,
				'정보없음',
				SUBSTR(BIRTH, 3, 2) || '.' || SUBSTR(BIRTH, 5,2) || '.' || SUBSTR(BIRTH, 7, 2)
         	) CBIRTH		  
		FROM TBL_USER U  		
	</select>
	
	
	<select id="memberCheck" parameterType="hashmap" resultType="com.example.test1.model.Member">
		SELECT *
		FROM TBL_USER
		WHERE USERID = #{userId}   	
	</select>

	<select id="statusCheck" parameterType="hashmap" resultType="com.example.test1.model.Member">
		SELECT *
		FROM TBL_USER
		WHERE STATUS = #{userId}   	
	</select>
	
	<insert id="memberAdd" parameterType="hashmap">
		INSERT INTO TBL_USER 
		VALUES(#{userId}, #{pwd}, #{name}, NULL, NULL, NULL, #{addr}, #{phone},
		       NULL, #{gender}, #{status}, SYSDATE, SYSDATE)
	</insert>
	
	
	<insert id="insertUserImg" parameterType="hashmap">
		INSERT INTO TBL_USER_FILE
		VALUES(FILE_SEQ.NEXTVAL, #{userId}, #{path}, #{fileName}, #{orgName}, #{size}, #{ext})
	</insert>
	
	
	<!--login fail시-->
	<update id="cntIncrease" parameterType="hashmap">
		UPDATE TBL_USER
		SET
			CNT = CNT + 1
		WHERE USERID = #{id}	
	</update>
	
	
	<!--login success시-->
	<update id="cntInit" parameterType="hashmap">
		UPDATE TBL_USER
		SET
			CNT = 0
		WHERE USERID = #{id}	
	</update>
	
	
</mapper>




